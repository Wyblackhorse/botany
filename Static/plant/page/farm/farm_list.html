<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>账单</title>
    <link rel="stylesheet" href="../../assets/libs/layui/css/layui.css"/>
    <link rel="stylesheet" href="../../assets/module/admin.css?v=318"/>

    <style>

        .currSerachBtn{
            box-shadow: 0 15px 18px -6px rgb(45 140 240 / 65%) !important;
        }

        .currReloadBtn{
            box-shadow: 0 15px 18px -6px rgb(146 109 222 / 65%) !important;
        }

        .layui-table-cell{
            height:60px;
            line-height: 60px;
        }

        .images_tool{

            width: 50px;
        }


        .total-le-out {
            background: #5ba6fd;
            border: 4px solid #133f73;
            box-shadow: 0 4px 0 rgb(0 0 0 / 20%), inset 0 -4px 0 #3f87dd, inset 0 3px 0 #8cd6ff;
            border-radius: 12px;
            height: 52px;
            min-width: 150px;
        }

        .tw-p-1 {
            padding: 0.25rem;
        }

         .tw-gap-2 {
             gap: 0.5rem;
         }

         .tw-flex-row {
             flex-direction: row;
         }

         .tw-cursor-pointer {
             cursor: pointer;
         }

         .tw-flex {
             display: flex;
         }

         .tw-relative {
             position: relative;
         }

        .tw-p-1 {
            padding: 0.25rem;
        }

         .tw-bg-green-total-le {
             --tw-bg-opacity: 1;
             background-color: rgba(52, 119, 200, var(--tw-bg-opacity));
         }

         .tw-rounded-md {
             border-radius: 0.375rem;
         }

         .tw-gap-2 {
             gap: 0.5rem;
         }

         .tw-flex-row {
             flex-direction: row;
         }

         .tw-flex-grow {
             flex-grow: 1;
         }

        .tw-flex {
            display: flex;
        }

        .tw-flex-grow-0 {
            flex-grow: 0;
        }

         .tw-relative {
             position: relative;
         }

        .tw-w-5 {
            width: 1.25rem;
        }

         .tw-h-6 {
             height: 1.5rem;
         }

         .tw-m-auto {
             margin: auto;
         }

        .tw-flex-grow {
            flex-grow: 1;
        }

        .wallet-text {
            font-family: Poppins;
            font-size: 18px;
            font-style: normal;
            font-weight: 700;
            letter-spacing: 0;
            text-align: left;
            color: #fff;
        }

        .exchange-sapling {
            background: #5ba6fd;
            border: 4px solid #133f73;
            box-shadow: 0 4px 0 rgb(0 0 0 / 20%), inset 0 -4px 0 #3f87dd, inset 0 3px 0 #8cd6ff;
            border-radius: 12px;
            padding: 4px;
            display: flex;
            align-items: center;
            margin-bottom: 2.5rem;
            cursor: pointer;
            justify-content: space-around;
        }


        .exchange-sapling-inner {
            background: #3477c8;
            border-radius: 6px;
            padding: 0 24px 0 8px;
        }

         .tw-items-center {
             align-items: center;
         }

         .tw-flex {
             display: flex;
         }


        .exchange-sapling img {
            width: 34px;
        }

        .exchange-number {
            font-weight: 700;
            font-size: 28px;
            line-height: 18px;
            color: #fff;
            margin-left: 16px;
        }


         .tw-w-4 {
             width: 1rem;
         }

         .tw-h-6 {
             height: 1.5rem;
         }

         .tw-ml-2 {
             margin-left: 0.5rem;
         }


    </style>


    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- 正文开始 -->
<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-body">
            <!-- 表格工具栏 -->
            <form class="layui-form toolbar">
<!--                style="margin-left: -45px"-->
                <div class="layui-form-item" >
                    <div class="layui-inline" style="margin-left: -30px;">
                        <label class="layui-form-label">账号列表:</label>
                        <div class="layui-input-inline">
                            <select name="plant_account_id" id="plant_account_id"  lay-filter="play_kindS">
                            </select>
                        </div>

                    </div>

                    <div class="layui-inline">&emsp;
                        <button class="layui-btn icon-btn currReloadBtn" lay-filter="userTbSearch" lay-submit style="background-color: #926dde;border-color: #926dde;">
                            <i class="layui-icon layui-icon-refresh"></i>刷新数据
                        </button>
                        <button class="layui-btn icon-btn currReloadBtn" id="reload_farm" style="background-color: #33cabb;border-color: #33cabb;" >
                            <i class="layui-icon layui-icon-refresh"></i>刷新农场
                        </button>
                        <button class="layui-btn icon-btn currReloadBtn" id="reload_tool"  style="background-color: #F96197;border-color: #F96197;">
                            <i class="layui-icon layui-icon-refresh"></i>刷新工具
                        </button>
                    </div>

                    <div class="layui-inline" style="width: 150px;height: 66px">
                        <div class="tw-flex tw-flex-row tw-gap-2 tw-relative total-le-out tw-p-1 tw-cursor-pointer" style="height: 45px;">
                            <div class="tw-flex tw-flex-row tw-flex-grow tw-gap-2 tw-rounded-md tw-bg-green-total-le tw-p-1" style="height: 35px;">
                                <div class="tw-flex-grow-0 tw-relative">
                                    <img class="tw-w-5 tw-h-6 tw-m-auto" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjkiIGhlaWdodD0iMzAiIHZpZXdCb3g9IjAgMCAyOSAzMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTI3LjEyNzkgMTIuNzM3NUwyNy4xMjc4IDEyLjczNzRDMjYuOTIzNSAxMi4yNDQxIDI2LjQ0MiAxMS45MjI0IDI1LjkwODEgMTEuOTIyNEgxNy43ODE5TDE5LjMwNTIgMi4wMjExMUwxOS4zMDUyIDIuMDIxMDlDMTkuMzkyIDEuNDU2ODEgMTkuMTA2MiAwLjkwMDcwNSAxOC41OTcxIDAuNjQyNjMzTDE4LjM3MSAxLjA4ODYyTDE4LjU5NzEgMC42NDI2MzNDMTguMDg3NiAwLjM4NDQzNiAxNy40NzAyIDAuNDgzMTY2IDE3LjA2NjYgMC44ODY3NzJMMi4xMjk2NSAxNS44MjM3TDIuNDgzMjEgMTYuMTc3MkwyLjEyOTY1IDE1LjgyMzdDMS43NTIwMyAxNi4yMDEzIDEuNjM5MTMgMTYuNzY5MiAxLjg0MzQgMTcuMjYyNUwxLjg0MzQzIDE3LjI2MjZDMi4wNDc4IDE3Ljc1NTkgMi41MjkyMyAxOC4wNzc2IDMuMDYzMjIgMTguMDc3NkgxMS4xODkzTDkuNjY2MDUgMjcuOTc4OUw5LjY2NjA1IDI3Ljk3ODlDOS41NzkyNiAyOC41NDMyIDkuODY0OTcgMjkuMDk5MyAxMC4zNzQyIDI5LjM1NzRDMTAuODgzNiAyOS42MTU2IDExLjUwMSAyOS41MTY4IDExLjkwNDYgMjkuMTEzMkwyNi44NDE2IDE0LjE3NjNDMjcuMjE5MiAxMy43OTg3IDI3LjMzMjIgMTMuMjMwOSAyNy4xMjc5IDEyLjczNzVaIiBmaWxsPSIjOENENkZGIiBzdHJva2U9IiMxNDE2NDciLz4KPC9zdmc+Cg==">
                                </div>
                                <div class="tw-flex-grow">
                                    <p class="wallet-text" id="leWallet">0</p>
                                </div>
                            </div>
                            <div class="tw-flex-grow-0 tw-relative tw-m-auto">
                                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2IDIuNUwxMiA2LjUwMDAzSDE1VjEzLjVDMTUgMTQuNjA1IDE0LjEwNSAxNS41IDEzIDE1LjVDMTEuODk1IDE1LjUgMTEgMTQuNjA1IDExIDEzLjVWNi41MDAwM0MxMSA0LjI5NTAzIDkuMjA0OTggMi41MDAwNSA2Ljk5OTk4IDIuNTAwMDVDNC43OTQ5OCAyLjUwMDA1IDMgNC4yOTUwMyAzIDYuNTAwMDNWMTMuNUgwTDMuOTk5OTggMTcuNUw4LjAwMDAxIDEzLjVINS4wMDAwMVY2LjUwMDAzQzUuMDAwMDEgNS4zOTUwNSA1Ljg5NSA0LjUwMDAxIDcuMDAwMDMgNC41MDAwMUM4LjEwNTA2IDQuNTAwMDEgOC45OTk5OSA1LjM5NSA4Ljk5OTk5IDYuNTAwMDNWMTMuNUM4Ljk5OTk5IDE1LjcwNSAxMC43OTUgMTcuNSAxMyAxNy41QzE1LjIwNSAxNy41IDE3IDE1LjcwNSAxNyAxMy41VjYuNTAwMDNIMjBMMTYgMi41WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==">
                            </div>
                        </div>

                    </div>

                    <div class="layui-inline" style="width: 180px;height: 66px;margin-left: 20px">
                        <div class="exchange-sapling">
                            <div class="tw-flex tw-items-center exchange-sapling-inner" style="margin-left: 20px;">
                                <img src="../../assets/images/sm1.png">
                                <span class="exchange-number" id="usagesSunflower">0</span>
                            </div>
                            <div>
                                <img class="tw-w-4 tw-h-6 tw-ml-2" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2IDIuNUwxMiA2LjUwMDAzSDE1VjEzLjVDMTUgMTQuNjA1IDE0LjEwNSAxNS41IDEzIDE1LjVDMTEuODk1IDE1LjUgMTEgMTQuNjA1IDExIDEzLjVWNi41MDAwM0MxMSA0LjI5NTAzIDkuMjA0OTggMi41MDAwNSA2Ljk5OTk4IDIuNTAwMDVDNC43OTQ5OCAyLjUwMDA1IDMgNC4yOTUwMyAzIDYuNTAwMDNWMTMuNUgwTDMuOTk5OTggMTcuNUw4LjAwMDAxIDEzLjVINS4wMDAwMVY2LjUwMDAzQzUuMDAwMDEgNS4zOTUwNSA1Ljg5NSA0LjUwMDAxIDcuMDAwMDMgNC41MDAwMUM4LjEwNTA2IDQuNTAwMDEgOC45OTk5OSA1LjM5NSA4Ljk5OTk5IDYuNTAwMDNWMTMuNUM4Ljk5OTk5IDE1LjcwNSAxMC43OTUgMTcuNSAxMyAxNy41QzE1LjIwNSAxNy41IDE3IDE1LjcwNSAxNyAxMy41VjYuNTAwMDNIMjBMMTYgMi41WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==">
                            </div>
                        </div>


                    </div>


                    <div class="layui-inline" style="float: right;margin-right: 20px">
                        <image src="../../assets/images/xp.jpg" class="images_tool"></image>
                        <span id="xp">0</span>
                        <image src="../../assets/images/dp.jpg" class="images_tool"></image>
                        <span id="dp">0</span>
                        <image src="../../assets/images/s.jpg" class="images_tool"></image>
                        <span id="s">0</span>
                        <image src="../../assets/images/ws.jpg" class="images_tool"></image>
                        <span id="ws">0</span>
                        <image src="../../assets/images/wy.jpg" class="images_tool"></image>
                        <span id="wy">0</span>
                    </div>


                </div>

            </form>
<!--            <div class="layui-inline">&emsp;-->

<!--                <button class="layui-btn icon-btn currReloadBtn" id="reload_farm" style="background-color: #33cabb;border-color: #33cabb;" >-->
<!--                    <i class="layui-icon layui-icon-refresh"></i>刷新农场-->
<!--                </button>-->
<!--                <button class="layui-btn icon-btn currReloadBtn" lay-filter="reload_tool"  style="background-color: #F96197;border-color: #F96197;">-->
<!--                    <i class="layui-icon layui-icon-refresh"></i>刷新工具-->
<!--                </button>-->
<!--            </div>-->
            <!-- 数据表格 -->
            <table id="userTable" lay-filter="userTable" style="margin-top:10px"></table>
        </div>
    </div>
</div>

<!-- js部分 -->
<script type="text/javascript" src="../../assets/libs/layui/layui.js"></script>
<script type="text/javascript" src="../../assets/js/common.js?v=318"></script>

<script type="text/javascript" src="../../assets/js/jquery.min.js"></script>
<script type="text/javascript" src="../../assets/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="../../assets/js/config.url.js"></script>

<!--数据表格操作工具栏-->
<script type="text/html" id="orderListBar">

<!--    <a class="layui-btn layui-btn-normal layui-btn-radius" lay-event="addplaydetailbtn" style="background-color: #337ab7"><i class="layui-icon layui-icon-add-1"></i>添加具体玩法</a>-->
<!--    <a class="layui-btn layui-btn-normal layui-btn-radius" lay-event="lookplaydetailbtn" style="background-color: #FF09E5;"><i class="layui-icon layui-icon-screen-full"></i>查看具体玩法</a>-->
<!--    <a class="layui-btn layui-btn-normal layui-btn-radius" lay-event="changebtn"><i class="layui-icon layui-icon-edit"></i>修改</a>-->
<!--    <a class="layui-btn layui-btn-normal layui-btn-danger layui-btn-radius" lay-event="delbtn"><i class="layui-icon">&#x1006;</i>删除</a>-->

</script>
<script>

    var mybck= $.cookie('tokenMyb');
    //alert(document.cookie);
    //console.log(mybck)
    if(mybck == "" || mybck == null){

        window.top.location.href="../../login.html";

    }else{
        global_token = mybck
        var currSelectReturnID
        var jsondata ;
        var playKindsArray;
        var playKindsOneArray;
        var playKindsOneNewArray;
        var arrsData;
        var arrsAllData=[];
        layui.use(['layer', 'form', 'table', 'util', 'admin', 'xmSelect','notice','treeTable'], function () {
            var $ = layui.jquery;
            var layer = layui.layer;
            var form = layui.form;
            var table = layui.table;
            var util = layui.util;
            var admin = layui.admin;
            var xmSelect = layui.xmSelect;
            var notice = layui.notice;
            var treeTable = layui.treeTable;



            var get_playKind_request_param = {};
            // get_playKind_request_param['token']= $.cookie('tokenMyb');

            // get_playKind_request_param['min_Time']= 0;
            get_playKind_request_param['status']= 1;
            get_playKind_request_param['id']= 99999999;
            get_playKind_request_param['action']= 'select';

            /* 普通table-渲染表格 */
            var insTb = table.render({
                elem: '#userTable',
                url: global_request_refresh_botany+"?token="+global_token,
                // url: "www.baidu.com",
                method: 'post',
                where:get_playKind_request_param,
                // toolbar: ['<p>',
                //     '<button lay-event="add" class="layui-btn layui-btn-sm icon-btn"><i class="layui-icon">&#xe654;</i>添加</button>&nbsp;',
                //     '<button lay-event="del" class="layui-btn layui-btn-sm layui-btn-danger icon-btn"><i class="layui-icon">&#xe640;</i>删除</button>',
                //     '</p>'].join(''),
                cellMinWidth: 100,
                page :  { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                    layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'] //自定义分页布局
                    //,curr: 5 //设定初始在第 5 页
                    ,groups: 10 //只显示 1 个连续页码
                    ,first: "首页" //不显示首页
                    ,last: "尾页"//不显示尾页
                },
                height : "full-100",
                limit : 15,
                limits : [15,30,50,100] ,
                response: {
                    statusName: 'status' //规定数据状态的字段名称，默认：code
                    // ,statusCode: 0 //规定成功的状态码，默认：0
                    // ,msgName: 'hint' //规定状态信息的字段名称，默认：msg
                    // ,countName: 'total' //规定数据总数的字段名称，默认：count
                    // ,dataName: 'result' //规定数据列表的字段名称，默认：data
                },
                // id : "systemLog",
                cols: [[
                    {type: 'checkbox'},
                    // {field: 'id',title:'ID',sort: true,align:"center",width:130},
                    {field: '_id', title: 'ID', sort: true,align:"center",width:228},

                    // {field: 'needWater', title: '需要浇水', sort: true,align:"center",templet:function(d){
                    //
                    //         if(d.needWater == 2){
                    //             // return '否';
                    //             return '<span >'+'否'+'</span>'
                    //         }else{
                    //             return '<span style="color: red;font-weight: bold;font-size: 18px">'+'真'+'</span>'
                    //         }
                    //
                    // }},
                    // {field: 'hasSeed', title: '需要种子', sort: true,align:"center",templet:function(d){
                    //
                    //         if(d.hasSeed == 2){
                    //             return '否';
                    //         }else{
                    //             return '<span style="color: red;font-weight: bold;font-size: 18px">'+'真'+'</span>'
                    //         }
                    //
                    // }},

                    {field: 'activeTools', title: '工具(盆/水)', sort: true,align:"center",templet:function(d){
                            // console.log("d",d)
                            if(d.activeTools.length === 0 ){
                                return '<div><img src="../../assets/images/xp.jpg" ' + 'alt="" width="40px" height="40px" ><span style="vertical-align: middle;font-size: 15px !important;margin-left: 5px;">'+'0'+'</span><img src="../../assets/images/s.jpg" ' + 'alt="" width="40px" height="40px" ><span style="vertical-align: middle;font-size: 15px !important;margin-left: 5px;">'+'0'+'</span></div>';

                            }else{
                                return '<div><img src="../../assets/images/xp.jpg" ' + 'alt="" width="40px" height="40px" ><span style="vertical-align: middle;font-size: 15px !important;margin-left: 5px;">'+d.activeTools[0]['count']+'</span><img src="../../assets/images/s.jpg" ' + 'alt="" width="40px" height="40px" ><span style="vertical-align: middle;font-size: 15px !important;margin-left: 5px;">'+d.activeTools[1]['count']+'</span></div>';
                            }


                    }},


                    {field: 'totalHarvest', title: '能量值', sort: true,align:"center",width:108},

                    {field: 'harvestTime', title: '收货时间',width:170, sort: true,align:"center", templet: function (d) {
                            // return util.toDateString(d.harvestTime* 1000);
                            return transformTimestamp(d.harvestTime)
                        }, sort: true
                    },
                    {field: 'plantType', title: '植物类型', sort: true,width:130,align:"center",templet:function(d){

                            if(d.plantId == "" ||  d.plantId == undefined ||  d.plantId == 0 ){
                                if(d.plantType == 1){
                                    return '<div><img src="../../assets/images/sm.png" ' + 'alt="" width="40px" height="40px"></a></div>';
                                }else if(d.plantType == 2){
                                    return '<div><img src="../../assets/images/mm.png" ' + 'alt="" width="40px" height="40px"></a></div>';
                                }
                            }else{
                                return '<div><img src="'+d.iconUrl+'" ' + 'alt="" width="40px" height="40px"></a></div>'
                            }

                    }},
                    {field: 'stage', title: '是否存在乌鸦', sort: true,align:"center",templet:function(d){

                            if(d.stage == "paused"){
                                return '<div><img src="../../assets/images/czwy.jpg" ' + 'alt="" width="50px" height="60px"></a></div>'
                            }else{
                                return '<div><img src="../../assets/images/bczwy.png" ' + 'alt="" width="50px" height="60px"></a></div>'
                            }
                    }},
                    {field: 'plantId', title: '植物ID',width:125, sort: true,align:"center",templet:function(d){

                            if(d.plantId == "" ||  d.plantId == undefined ||  d.plantId == 0){
                                return '无';
                            }else{
                                return d.plantId
                            }
                    }},
                    // {field: 'iconUrl', title: '植物图片', sort: true,align:"center",templet:function(d){
                    //
                    //         if(d.plantId == "" ||  d.plantId == undefined){
                    //             return '无';
                    //         }else{
                    //             return '<div><img src="'+d.iconUrl+'" ' + 'alt="" width="40px" height="40px"></a></div>'
                    //         }
                    // }},
                    {field: 'stage', title: '植物状态',width:115, sort: true,align:"center",templet:function(d){

                            //news new ?? 新种植
                            //farming 正在耕种
                            //paused 铲除
                            //cancelled 取消

                            if(d.stage == "new"){
                                // return '<span style="background-color: #926dde">'+'新种植'+'</span>'
                                return '<button class="layui-btn  layui-btn-sm" style="background-color: #926dde;border-color: #926dde;">'+'新种植'+'</button>'
                            }else if(d.stage == "farming"){
                                // return '<span style="background-color: #57c7d4">'+'运作中'+'</span>'
                                return '<button class="layui-btn  layui-btn-sm" style="background-color: #57c7d4;border-color: #57c7d4;">'+'运作中'+'</button>'
                            }else if(d.stage == "paused"){
                                // return '<span style="background-color: #465161">'+'暂停,有乌鸦'+'</span>'
                                return '<button class="layui-btn  layui-btn-sm" style="background-color: #465161;border-color: #465161;">'+'暂停,有乌鸦'+'</button>'
                            }else if(d.stage == "cancelled"){
                                // return '<span style="background-color: #33CABB">'+'耕种完'+'</span>'
                                return '<button class="layui-btn  layui-btn-sm" style="background-color: #33CABB;border-color: #33CABB;">'+'耕种完'+'</button>'
                            }else{
                                return ''
                            }
                    }},

                    // {field: 'date', title: '日期', sort: true,align:"center",templet:function(d){
                    //
                    //         return d.date
                    //         // return '<span>1:'+'<span style="color: red">'+d.per_value+'</span>'+'</span>'
                    //
                    // }},

                    // {field: 'profit', title: '亏损额', sort: true,align:"center",templet:function(d){
                    //
                    //
                    //         if(parseInt(d.profit) == 0){
                    //
                    //             return d.profit
                    //
                    //         }else{
                    //             if(d.profit.indexOf('-') == -1){
                    //
                    //                 return '<span style="color: green">'+d.profit+'</span>'
                    //
                    //             }else{
                    //                 return '<span style="color: red">'+d.profit+'</span>'
                    //             }
                    //         }
                    //
                    //     }},
                    // {field: 'result', title: '开奖结果', sort: true,align:"center",templet:function(d){
                    //
                    //
                    //         if(d.status == 4){
                    //
                    //             return '<span style="color: red;font-size: 18px;font-weight: bold">'+'无效'+'</span>'
                    //
                    //         }else{
                    //
                    //             if(d.result == '' || d.result == null ){
                    //                 return '<span style="color: green;font-size: 18px;font-weight: bold">'+'还未结算'+'</span>'
                    //             }else{
                    //                 return '<span style="color: green;font-size: 18px;font-weight: bold">'+d.result+'</span>'
                    //             }
                    //
                    //         }
                    //
                    //
                    //
                    // }},



                    //
                    // {field: 'max_bet', title: '最大投注', sort: true,align:"center",templet:function(d){
                    //
                    // 		return '<span style="color: darkgreen">'+d.max_bet+'</span>'
                    //
                    // }},

                    // {field: 'time', title: '倒计时', sort: true,align:"center",templet:function(a){
                    //
                    //         // var configTime = parseInt(resultData.result.group_task_recall_time);
                    //
                    //         if(a.status == "1"){//开盘
                    //
                    //             var configTime = a.time;
                    //
                    //             if(a.created_at == "" || a.created_at == null){
                    //
                    //                 // return '<button class="layui-btn layui-bg-black layui-btn-xs">'+'未接任务()'+'</button>'
                    //
                    //                 return '';
                    //             }
                    //
                    //             // var abc = 1616427900;*60
                    //             // var endTime = Math.floor((abc + configTime * 60));
                    //             var endTime = Math.floor((a.created_at + configTime));
                    //
                    //             console.log("计算时间:"+endTime);
                    //             // 计算 剩下的秒，即留给审批的时间
                    //             var curTime = Math.round(new Date().getTime()  / 1000);
                    //             // console.log("系统当前时间："+curTime);
                    //             var t = endTime -  curTime
                    //             // var t = endTime - Math.floor(new Date().getTime() / 1000);
                    //             // 设置每一条数据唯一的key
                    //             var key = 'key_' + a.id;
                    //             // 判断是否逾期
                    //             if(t <= 0){
                    //
                    //                 // return
                    //
                    //                 // changeStatusList(a.id);
                    //                 //已逾期，直接返回，提示已逾期
                    //
                    //                 var min_Time = new Date(new Date().toLocaleDateString()).getTime()/1000
                    //                 var maxTime = new Date(new Date().toLocaleDateString()).getTime()/1000 + 24 * 60 * 60  - 1
                    //
                    //
                    //                 insTb.reload({
                    //                     url:js_global_requestAddress_get_periods,
                    //                     method: 'post',
                    //                     where: {
                    //                         token:$.cookie('tokenMyb'),
                    //                         status:1,
                    //                         min_Time:min_Time,
                    //                         max_Time:maxTime,
                    //                         play_kinds_id:currKindsID,
                    //                         action:'GET'
                    //                     }
                    //                 },false);
                    //
                    //
                    //
                    //
                    //                 return `<label  id=${key} style="color: red">已过期!</label>`;
                    //             }
                    //             //未逾期 > 开始处理剩余时间，将秒转为n日n时n分n秒的形式，代码在下方88-108行
                    //             var left_time =  secondToStr(t);
                    //             var html = `<label id=${key} style="color: red;">${left_time}</label>`;
                    //             addTask(key, function () {
                    //                 t--;
                    //                 var left =  secondToStr(t);
                    //                 $('#' + key).text(left);
                    //                 if (t == 0) {
                    //                     //倒计时结束，删除定时任务
                    //                     $('#' + key).css("color","black");
                    //                     $('#' + key).text("已失效.");
                    //                     $(".layui-laypage-btn")[0].click()
                    //                     delTask(key);
                    //                     // 可根据情况，进行逾期之后的操作
                    //                     //...........
                    //                     console.log("倒计时结束");
                    //
                    //                     // changeStatusList(a.id);
                    //                 }
                    //             });
                    //             return html;
                    //
                    //
                    //         }else{
                    //             return `<label  id=${key} style="color: red">已过期!</label>`;
                    //         }
                    //
                    //
                    //
                    //     }},



                    // {field: 'status', title: '状态', sort: true,align:"center",width:100,templet:function(d){
                    //
                    //         if(d.status == "1"){//正常
                    //             return '<button class="layui-btn  layui-btn-sm" style="background-color: #48b0f7;border-color: #48b0f7;">'+'正常'+'</button>'
                    //         }else{
                    //             return ''
                    //         }
                    // }},

                    // {
                    //     field: 'created_at', title: '创建时间',align:"center",width:175, templet: function (d) {
                    //         return util.toDateString(d.created_at* 1000);
                    //     }, sort: true
                    // },

                    // {
                    // 	field: 'updated_at', title: '更新时间',align:"center",width:175, templet: function (d) {
                    //
                    //         var timestamp = Date.parse(new Date());
                    //         var timeoutNum = GetDateDiff(util.toDateString(d.updated_at* 1000),util.toDateString(timestamp),'hour')
                    //         // console.log("当前时间差",timeoutNum)
                    //         if(timeoutNum >= 2){
                    //             return '<button class="layui-btn  layui-btn-sm" style="background-color: #f7487f;border-color: #f7487f;">'+util.toDateString(d.updated_at* 1000)+'</button>'
                    //         }else{
                    //             return util.toDateString(d.updated_at* 1000);
                    //         }
                    //
                    // 	}, sort: true
                    // },

                    // {title: '操作', width:250, templet:'#orderListBar',fixed:"right",align:"center"}
                ]],
                done: function (res, curr, count) {

                    currDataResS = count;
                    $('tr').css({'background-color': '#fff', 'color': '#191a1c'});
                }
            });


            var param={};
            // param['token']= $.cookie('tokenMyb');
            // param['status']= '1';
            param['page']= '1';
            param['limit']= '3000';
            param['action']= 'select';

            //获取账号列表添加到下拉框中
            $.ajax({
                url: global_request_get_account_numberInformation+"?token="+global_token,
                dataType: 'json',
                type: 'post',
                data: param,
                success: function (dataArray) {

                    if (dataArray.code != 0) {

                        // console.log(dataArray.msg)
                        // layer.msg(dataArray.msg);

                        return false;

                    }


                    var returnDataArray = dataArray.data

                    var currAccountID = returnDataArray[0].id
                    currSelectReturnID = currAccountID
                    // console.log("returnDataArray",returnDataArray)

                    $("#plant_account_id").empty();

                    $.each(returnDataArray, function (index, item) {
                        $('#plant_account_id').append(new Option(item.remark, item.id));// 下拉菜单里添加元素
                    });

                    //重新渲染 固定写法
                    form.render("select");



                    //刷新自己的工具信息
                    var param={};
                    param['id']= currAccountID;
                    $.ajax({
                        url: global_request_refresh_tools+"?token="+global_token,
                        dataType: 'json',
                        type: 'post',
                        data: param,
                        success: function (dataArray) {

                            if (dataArray.status != 0) {

                                // console.log(dataArray.msg)
                                layer.msg(dataArray.msg);

                                return false;

                            }

                            var dataArrayOBj = dataArray.data

                            // console.log("dataArray",dataArray)
                            dataArrayOBj.find((item)=>{

                                // console.log("item",item)

                                if(item.toolId == 1){
                                    $("#xp").text(item.usages)
                                }
                                if(item.toolId == 2){

                                }
                                if(item.toolId == 3){
                                    $("#s").text(item.usages)
                                }
                                if(item.toolId == 4){

                                }
                                if(item.toolId == 5){
                                    $("#wy").text(item.usages)
                                }

                            })


                        }
                    })

                    //刷新能量数据
                    var param={};
                    param['id']= currAccountID;
                    $.ajax({
                        url: global_request_getEnergy+"?token="+global_token,
                        dataType: 'json',
                        type: 'post',
                        data: param,
                        success: function (dataArray) {

                            if (dataArray.status != 0) {

                                // console.log(dataArray.msg)
                                layer.msg(dataArray.msg);

                                return false;

                            }

                            var dataArrayOBj = dataArray.data

                            $("#leWallet").text(dataArrayOBj.leWallet)
                            $("#usagesSunflower").text(dataArrayOBj.usagesSunflower)

                        }
                    })


                    insTb.reload({
                        // url:js_global_requestAddress_get_periods,
                        method: 'post',
                        where: {
                            id:currAccountID,
                            action:'select'
                        }
                    },false);



                    // get_playKind_request_param['token']= $.cookie('tokenMyb');
                    // get_playKind_request_param['status']= 1;
                    // get_playKind_request_param['min_Time']= 0;
                    // get_playKind_request_param['max_Time']= 0;
                    // get_playKind_request_param['play_kinds_id']= 0;
                    // get_playKind_request_param['action']= 'GET';
                    //
                    // insTb.reload({
                    //     // url:js_global_requestAddress_get_periods,
                    //     method: 'post',
                    //     where: {
                    //         token:$.cookie('tokenMyb'),
                    //         status:1,
                    //         min_Time:0,
                    //         max_Time:0.,
                    //         play_kinds_id:currKindsID,
                    //         action:'GET'
                    //     }
                    // },false);


                }
            })


            /* 下拉框选中事件 */
            form.on('select(play_kindS)', function (data) {


                currSelectReturnID = data.value

                //重载列表
                insTb.reload({
                    // url:js_global_requestAddress_get_periods,
                    method: 'post',
                    where: {
                        status:1,
                        id:currSelectReturnID,
                        action:'select'
                    },
                    done: function(res, curr, count){
                        //如果是异步请求数据方式，res即为你接口返回的信息。
                        //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
                        // console.log(res);
                        // //得到当前页码
                        // console.log(curr);
                        // //得到数据总量
                        // console.log(count);

                        if(count == 0){ //需要刷新农场

                            var param={};
                            param['id']= currSelectReturnID;

                            //刷新最新农场信息
                            $.ajax({
                                url: global_request_refresh_botany+"?token="+global_token,
                                dataType: 'json',
                                type: 'post',
                                data: param,
                                success: function (dataArray) {

                                    if (dataArray.code != 200) {

                                        // console.log(dataArray.msg)
                                        layer.msg(dataArray.msg);

                                        return false;

                                    }

                                }
                            })


                        }

                    }
                },false);

                //刷新自己的工具信息
                var param={};
                param['id']= currSelectReturnID;
                $.ajax({
                    url: global_request_refresh_tools+"?token="+global_token,
                    dataType: 'json',
                    type: 'post',
                    data: param,
                    success: function (dataArray) {

                        if (dataArray.status != 0) {

                            // console.log(dataArray.msg)
                            layer.msg(dataArray.msg);

                            return false;

                        }

                        var dataArrayOBj = dataArray.data

                        // console.log("dataArray",dataArray)
                        dataArrayOBj.find((item)=>{

                            // console.log("item",item)

                            if(item.toolId == 1){
                                $("#xp").text(item.usages)
                            }
                            if(item.toolId == 2){

                            }
                            if(item.toolId == 3){
                                $("#s").text(item.usages)
                            }
                            if(item.toolId == 4){

                            }
                            if(item.toolId == 5){
                                $("#wy").text(item.usages)
                            }

                        })


                    }
                })



                //刷新能量数据
                var param={};
                param['id']= currSelectReturnID;
                $.ajax({
                    url: global_request_getEnergy+"?token="+global_token,
                    dataType: 'json',
                    type: 'post',
                    data: param,
                    success: function (dataArray) {

                        if (dataArray.status != 0) {

                            // console.log(dataArray.msg)
                            layer.msg(dataArray.msg);

                            return false;

                        }

                        var dataArrayOBj = dataArray.data

                        $("#leWallet").text(dataArrayOBj.leWallet)
                        $("#usagesSunflower").text(dataArrayOBj.usagesSunflower)

                    }
                })

                return false;
            });


            $("#reload_tool").click(function () {

                //刷新自己的工具信息
                var param={};
                param['id']= currSelectReturnID;
                $.ajax({
                    url: global_request_refresh_tools+"?token="+global_token,
                    dataType: 'json',
                    type: 'post',
                    data: param,
                    success: function (dataArray) {

                        if (dataArray.status != 0) {

                            // console.log(dataArray.msg)
                            layer.msg(dataArray.msg);

                            return false;

                        }

                        var dataArrayOBj = dataArray.data

                        // console.log("dataArray",dataArray)
                        dataArrayOBj.find((item)=>{

                            // console.log("item",item)

                            if(item.toolId == 1){
                                $("#xp").text(item.usages)
                            }
                            if(item.toolId == 2){

                            }
                            if(item.toolId == 3){
                                $("#s").text(item.usages)
                            }
                            if(item.toolId == 4){

                            }
                            if(item.toolId == 5){
                                $("#wy").text(item.usages)
                            }

                        })


                    }
                })


                return false

            })



            $("#reload_farm").click(function () {

                var param={};
                param['id']= currSelectReturnID;

                //刷新最新农场信息
                $.ajax({
                    url: global_request_refresh_botany+"?token="+global_token,
                    dataType: 'json',
                    type: 'post',
                    data: param,
                    success: function (dataArray) {

                        if (dataArray.code != 200) {

                            // console.log(dataArray.msg)
                            layer.msg(dataArray.msg);

                            return false;

                        }

                        layer.msg(dataArray.msg, {icon: 1, time: 500}, function () {


                        });
                    }
                })

                return false

            })


            function transformTimestamp (timestamp) {
                //let a = new Date(timestamp).getTime();
                //const date = new Date(a);
                const date=new Date(timestamp)
                const Y = date.getFullYear() + '-';
                const M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
                const D = (date.getDate() < 10 ? '0' + date.getDate() : date.getDate()) + '  ';
                const h = (date.getHours() < 10 ? '0' + date.getHours() : date.getHours()) + ':';
                const m = (date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes())+ ':';
                const s = (date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds()); // 秒
                const dateString = Y + M + D + h + m+s;
                return dateString;
            }


        });

    }



</script>
</body>
</html>
